[supervisord]
nodaemon=true
user=appuser
logfile=/app/logs/supervisord.log
pidfile=/tmp/supervisord.pid
childlogdir=/app/logs

[program:aria2c]
command=aria2c --enable-rpc --rpc-listen-all=false --rpc-listen-port=6800 --conf-path=/etc/aria2/aria2.conf
autostart=true
autorestart=true
stdout_logfile=/app/logs/aria2c.log
stderr_logfile=/app/logs/aria2c_error.log
priority=1

[program:fastapi]
command=uvicorn app.main:app --host 0.0.0.0 --port 8080 --workers 4
directory=/app/backend
autostart=true
autorestart=true
stdout_logfile=/app/logs/fastapi.log
stderr_logfile=/app/logs/fastapi_error.log
priority=2

[program:celery-worker]
command=celery -A app.workers.celery_app worker --loglevel=info --concurrency=4
directory=/app/backend
autostart=true
autorestart=true
stdout_logfile=/app/logs/celery_worker.log
stderr_logfile=/app/logs/celery_worker_error.log
priority=3

[program:celery-beat]
command=celery -A app.workers.celery_app beat --loglevel=info
directory=/app/backend
autostart=true
autorestart=true
stdout_logfile=/app/logs/celery_beat.log
stderr_logfile=/app/logs/celery_beat_error.log
priority=3
